<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>George Pickens</title>
<link rel="icon" type="image/gif" href="https://gpsite.github.io/gp/img/halloween-logo.png">

<style>
:root {
  --bg:#000;
  --chip:#222428;
  --chip-hover:#2b2e33;
  --icon-border:#000;
  --blue:#ff7300;
  --green:#7ed321;
  --yellow:#ff7300;
  --red:#ff7300;
  --accent:#ff9900;
  --accent-2:#ffaa00;

  /* panel defaults */
  --blur: 0.4rem;
  --border-radius: 0.5rem;
  --border-width: 0.0625rem;
  --border-color: hsla(0, 0%, 20%, 0.1);
  --border-glow:  hsla(0, 0%, 7%, 0.2);
  --corner-glow:  hsla(0, 0%, 0%, 0.6);
  --corner-glow-size: 1;
  --padding-inline: 1.5em;
  --padding-block: 1.5em;
  --text-color: hsl(0 0 100%);
  --background-color: hsl(0 0 0% / 10%);
}

/* ---------- base ---------- */
html,body { height:100%; margin:0; }
body {
  background: var(--bg);
  color: #fff;
  font-family: "Segoe UI", sans-serif;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:flex-start;
  padding:20px;
  padding-bottom:90px;
  position:relative;
  z-index:2; /* on top of spooky scene */
  -webkit-font-smoothing:antialiased;
}

/* ---------- spooky background scene (fixed, behind everything) ---------- */
.scene {
  position: fixed;
  inset: 0;
  overflow: hidden;
  z-index: 0;
  pointer-events: none;
  isolation: isolate;
  background: #000;
}

.bg-room {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  filter: saturate(0.9);
  animation: flicker 8s infinite;
}
@keyframes flicker {
  0%,100%{filter:brightness(1) contrast(1) saturate(0.9);}
  25%{filter:brightness(0.85) contrast(1.1) saturate(1);}
  50%{filter:brightness(0.95) contrast(1.05) saturate(0.95);}
  75%{filter:brightness(0.8) contrast(1.15) saturate(1.05);}
}
.dark-overlay {
  position:absolute; inset:0;
  background: radial-gradient(circle at 50% 45%, transparent 0%, rgba(0,0,0,.55) 55%, rgba(0,0,0,.85) 100%);
  animation: pulse-dark 4s ease-in-out infinite;
}
@keyframes pulse-dark { 0%,100%{opacity:.35;} 50%{opacity:.75;} }

.fog {
  position:absolute; left:0; bottom:0;
  width:220%; height:50%;
  background: linear-gradient(to top, rgba(0,0,0,0.42), transparent 60%);
  animation: fog-move 24s linear infinite;
  mix-blend-mode: screen;
}
@keyframes fog-move { 0%{transform:translateX(0);} 100%{transform:translateX(-50%);} }

.shadow {
  position:absolute; width:150px; height:300px;
  background: rgba(0,0,0,.7); filter: blur(20px);
  animation: shadow-move 12s ease-in-out infinite;
}
.shadow-1 { top:20%; left:-150px; }
.shadow-2 { bottom:10%; right:-150px; animation-delay:6s; }
@keyframes shadow-move {
  0%,100%{transform:translateX(0);opacity:0;}
  25%{transform:translateX(200px);opacity:.5;}
  75%{transform:translateX(420px);opacity:.5;}
}

.clock-overlay {
  position:absolute; width:100px; height:100px;
  transform: translate(-95%, -100%);
  filter: drop-shadow(0 0 8px rgba(255,153,0,.85));
}
.clock-hand {
  position:absolute; top:50%; left:50%;
  transform: translate(-50%,-100%) rotate(0deg);
  transform-origin: bottom center;
  border-radius:2px;
}
.hour-hand { width:6px; height:40px; background:var(--accent); box-shadow:0 0 10px var(--accent); }
.minute-hand { width:4px; height:60px; background:var(--accent-2); box-shadow:0 0 8px var(--accent-2); }
.second-hand { width:2px; height:75px; background:#fff; box-shadow:0 0 6px #fff; }

.spooky-text {
  position:absolute;
  color:#8b0000;
  font-family: 'Creepster', 'Courier New', monospace;
  font-size:24px; font-weight:700;
  text-shadow: 0 0 10px rgba(139,0,0,.8), 0 0 20px rgba(139,0,0,.6), 0 0 30px rgba(139,0,0,.4);
  animation: appear-text 8s ease-in-out infinite;
  opacity:0;
}
@keyframes appear-text {
  0%,100%{opacity:0;transform:translateY(0) scale(1);}
  10%,90%{opacity:.95;transform:translateY(-10px) scale(1.05);}
}
.text-1 { top:15%; left:10%; animation-delay:0s; }
.text-2 { top:25%; right:15%; animation-delay:2s; font-size:20px; }
.text-3 { bottom:30%; left:20%; animation-delay:4s; font-size:28px; }
.text-4 { top:40%; right:10%; animation-delay:6s; font-size:22px; }

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  .bg-room, .dark-overlay, .fog, .shadow, .spooky-text, .clock-hand { animation: none !important; }
}

/* ---------- glass / panel / vivid (user-provided styles, trimmed/adapted) ---------- */
.panel {
  position: relative;
  box-sizing: border-box;
  background: linear-gradient(var(--background-color), var(--background-color)) border-box;
  background-blend-mode: overlay;
  color: var(--text-color);
  border-radius: var(--border-radius);
  display: flex;
  flex-direction: column;
  padding-inline: var(--padding-inline);
  padding-block: var(--padding-block);
  text-shadow: 0 0 1.5em black;
  backdrop-filter: none;
}
.glass {
  border-radius: var(--border-radius);
  background-color: var(--background-color);
  backdrop-filter: blur(var(--blur));
  background-blend-mode: plus-lighter;
  box-shadow:
    0 0 0 var(--border-width) var(--border-color) inset,
    0 0 3rem -1rem hsl(0 0 0 / 0.2),
    0 0 1rem -0.5rem hsl(0 0 0 / 0.2),
    0 0 3rem 0 hsl(0 0 100% / 0.15) inset,
    0 0 0.25rem 0 hsl(0 0 100% / 0.15) inset;
}
.glass:before {
  content:""; display:block; position:absolute; inset:0; pointer-events:none; border-radius:inherit;
  background:
    conic-gradient(from -100deg at center, transparent 0%, var(--border-glow) 10%, transparent 50%, var(--border-glow), transparent 70%);
  mask:
    linear-gradient(transparent),
    linear-gradient(white);
  mask-clip: content-box, border-box;
  mask-composite: subtract;
  mask-repeat: no-repeat;
}
.glass:after {
  content:""; display:block; position:absolute; left:0; top:0; pointer-events:none; border-radius:inherit;
  width:min(100%, calc(var(--border-radius) * var(--corner-glow-size)));
  height:min(100%, calc(var(--border-radius) * var(--corner-glow-size)));
  padding: min(100%, calc(var(--border-radius) * var(--corner-glow-size)));
  background:
    conic-gradient(from -90deg at center, transparent 8%, var(--corner-glow), transparent 17%);
  mask-image:
    linear-gradient(transparent),
    linear-gradient(white);
  mask-clip: padding-box, border-box;
  mask-composite: subtract;
  mask-repeat: no-repeat;
}

.vivid {
  --blur: 1em;
  --border-color: hsl(0 0 100% / 0.2);
  border: var(--border-width) outset var(--border-color);
  border-radius: calc(var(--border-radius) + var(--border-width));
  min-height: calc(1.66em + var(--padding-block) * 2 );
  box-shadow:
    0 0 3rem -1rem hsl(0 0 0 / 0.2),
    0 0 1rem -0.5rem hsl(0 0 0 / 0.2),
    0 0 3rem 0 hsl(0 0 100% / 0.15) inset,
    0 0 0.25rem 0 hsl(0 0 100% / 0.15) inset;
}
.vivid > * { position:relative; z-index:1; }

.vivid::before {
  --offset: var(--blur);
  content:""; position:absolute; pointer-events:none;
  height:calc(100% + (var(--offset) * 2));
  width:calc(100% + (var(--offset) * 2));
  top:calc(-1 * var(--offset));
  left:calc(-1 * var(--offset));
  border: calc(1 * var(--offset)) solid transparent;
  backdrop-filter: blur(var(--blur)) contrast(150%) grayscale(20%);
  box-sizing:border-box; border-radius: calc(var(--border-radius) + var(--offset));
  mask: linear-gradient(white);
  mask-clip: padding-box;
  mask-composite: subtract;
}
.vivid::after {
  content:""; position:absolute; pointer-events:none; z-index:0;
  height:calc(100% - var(--blur)); width:calc(100% - var(--blur));
  top:calc(var(--blur) / 2); left:calc(var(--blur) / 2);
  border-radius:inherit;
  background-image: var(--bgImage);
  background-size: cover; background-repeat:no-repeat; background-position:center; background-attachment: fixed;
  filter: blur(var(--blur)) contrast(100%) grayscale(20%);
  mix-blend-mode: normal;
}

/* Provide a tasteful default background-image used by vivid panels (can be overridden inline) */
:root { --bgImage: url('https://gpsite.github.io/gp/img/home/habitacion-2.png'); }

/* ---------- site layout (kept from your last combined version) ---------- */
header { margin-top:20px; margin-bottom:30px; text-align:center; z-index:2; }
header img { width:200px; border-radius:20px; }

.main-row {
  width:100%; max-width:1250px;
  display:flex; flex-direction:column; align-items:stretch; gap:40px;
  z-index:2;
}

/* Menu / Buttons */
nav.menu {
  display:flex; flex-direction:column; gap:20px; width:100%; max-width:460px; margin:0 auto 40px;
  z-index:2;
}
.btn {
  display:flex; align-items:center; gap:18px;
  text-decoration:none; color:#fff;
  padding:18px 24px; border-radius:16px; font-size:26px; letter-spacing:2px;
  transition: transform .1s ease, background .2s ease;
  position:relative; overflow:hidden;
}
.btn:hover { transform: translateY(-2px); }

/* make anchor behave with panel background: remove its native background and let glass styles show */
.btn.glass { background: transparent; padding: 0; }
.btn.glass > .panel { width:100%; display:flex; align-items:center; gap:18px; padding-block:14px; padding-inline:18px; box-sizing:border-box; }

.quad { display:grid; grid-template-columns:1fr 1fr; gap:4px; width:36px; height:36px; padding:4px; background:#222428; border-radius:8px; box-shadow:0 0 0 2px var(--icon-border) inset; }
.sq { border-radius:4px; }
.sq.blue { background:var(--blue); } .sq.green { background:var(--green); } .sq.yellow { background:var(--yellow); } .sq.red { background:var(--red); }

/* Announcements (apply vivid glass panel) */
.announcements {
  width:100%; max-width:680px; overflow:hidden; line-height:1.5; z-index:2;
  display:flex; flex-direction:column;
}
.announcements h2 { margin:0 0 12px 0; font-size:24px; }
.announcements-content { font-size:16px; line-height:1.5; flex:1 1 auto; overflow-y:auto; padding-right:4px; scrollbar-width:thin; background: transparent; }
.announcements-content ul { margin:0; padding-left:22px; }
.announcements-content li { margin-bottom:12px; }

/* Two-column layout for wide screens */
@media (min-width:900px) {
  .main-row { flex-direction:row; align-items:stretch; justify-content:center; }
  .announcements { flex:1 1 55%; }
  nav.menu { flex:0 0 420px; margin:0; }
}

/* Mobile tweaks */
@media (max-width:600px) {
  .btn { font-size:20px; padding:14px 18px; }
  header img { width:150px; }
}

/* Optional nicer thin scrollbar (webkit) */
.announcements-content::-webkit-scrollbar { width:8px; }
.announcements-content::-webkit-scrollbar-track { background:#1a1c1f; border-radius:8px; }
.announcements-content::-webkit-scrollbar-thumb { background:#3a3d42; border-radius:8px; }
.announcements-content::-webkit-scrollbar-thumb:hover { background:#4a4d52; }
</style>
</head>

<body>
  <!-- Spooky Background -->
  <div class="scene" aria-hidden="true">
    <img src="https://gpsite.github.io/gp/img/home/habitacion-2.png" alt="" class="bg-room" />
    <div class="dark-overlay"></div>
    <div class="fog"></div>
    <div class="shadow shadow-1"></div>
    <div class="shadow shadow-2"></div>

    <div class="clock-overlay" aria-hidden="true">
      <div class="clock-hand hour-hand"></div>
      <div class="clock-hand minute-hand"></div>
      <div class="clock-hand second-hand"></div>
    </div>

    <div class="spooky-text text-1">Time stands still...</div>
    <div class="spooky-text text-2">You are not alone...</div>
    <div class="spooky-text text-3">Tic... Tac...</div>
    <div class="spooky-text text-4">Do you hear the whispers?</div>
  </div>

  <!-- Page content (above spooky scene) -->
  <header>
    <img src="https://gpsite.github.io/gp/img/halloween-logo.png" alt="GP Logo">
  </header>

  <div class="main-row">
    <!-- Quick survey panel (vivid glass) -->
    <section class="announcements panel glass vivid" style="--bgImage:url(https://gpsite.github.io/gp/img/home/habitacion-2.png');">
      <h2>LAST DAY FOR SURVEY</h2>
      <div class="announcements-content">
        <ul>
          <li><b><a href="https://docs.google.com/forms/d/e/1FAIpQLSeRFwPmt8m8cPhrMoMa5M5-UMK7qEujuFKkFVrvzKg8lWRCCg/viewform?usp=header" style="color:inherit; text-decoration:underline;">Complete this quick anonymous survey for our class!</a></b></li>
        </ul>
      </div>
    </section>

    <!-- Announcements (vivid glass) -->
    <section id="announcementsBox" class="announcements panel glass vivid" style="--bgImage:url('https://gpsite.github.io/gp/img/home/habitacion-2.png');">
      <h2>Announcements</h2>
      <div class="announcements-content" id="announcementsContent">
        <ul>
          <li><b>LOADING ANNOUNCEMENTS...</b></li>
        </ul>
      </div>
    </section>

    <!-- Menu (buttons as glass) -->
    <nav class="menu" id="buttonsColumn">
      <a class="btn glass" href="pages/games/index.html" aria-label="Games">
        <div class="panel glass vivid" style="--bgImage:url('https://gpsite.github.io/gp/img/home/habitacion-2.png');">
          <span class="quad">
            <span class="sq blue"></span><span class="sq green"></span>
            <span class="sq yellow"></span><span class="sq red"></span>
          </span>
          <span>GAMES</span>
        </div>
      </a>

      <a class="btn glass" href="pages/movies/index.html" aria-label="Movies">
        <div class="panel glass vivid" style="--bgImage:url('https://gpsite.github.io/gp/img/home/habitacion-2.png');">
          <span class="quad">
            <span class="sq blue"></span><span class="sq green"></span>
            <span class="sq yellow"></span><span class="sq red"></span>
          </span>
          <span>MOVIES</span>
        </div>
      </a>

      <a class="btn glass" href="pages/chat/index.html" aria-label="Chat">
        <div class="panel glass vivid" style="--bgImage:url('https://gpsite.github.io/gp/img/home/habitacion-2.png');">
          <span class="quad">
            <span class="sq blue"></span><span class="sq green"></span>
            <span class="sq yellow"></span><span class="sq red"></span>
          </span>
          <span>CHAT (BETA)</span>
        </div>
      </a>

      <a class="btn glass" href="pages/ai/index.html" aria-label="GP-CLANKER">
        <div class="panel glass vivid" style="--bgImage:url('https://gpsite.github.io/gp/img/home/habitacion-2.png');">
          <span class="quad">
            <span class="sq blue"></span><span class="sq green"></span>
            <span class="sq yellow"></span><span class="sq red"></span>
          </span>
          <span>GP-CLANKER</span>
        </div>
      </a>
    </nav>
  </div>

  <!-- Announcements fetch + markup parser (restored from your original) -->
  <script>
  (function(){
    const SHEETS_ENDPOINT = 'https://sheets.googleapis.com/v4/spreadsheets/1nw0SDop0IeFr6q776thp_eSCZZulaxZBtM55ECrHD5A/values/home?key=AIzaSyBdnupZe6bJH43XE0Hj77n0AmlR3wVfN9M';
    const contentEl = document.getElementById('announcementsContent');
    if (!contentEl) return;

    // Allowed named colors whitelist
    const ALLOWED_NAMED_COLORS = new Set([
      'black','white','gray','grey','silver','lightgray','darkgray',
      'red','crimson','maroon','orange','coral','tomato',
      'yellow','gold','khaki',
      'green','lime','olive','seagreen','teal',
      'blue','navy','royalblue','dodgerblue','deepskyblue','skyblue',
      'indigo','violet','purple','magenta','fuchsia','pink','hotpink',
      'cyan','aqua','turquoise'
    ]);

    function normalizeColor(input) {
      if (!input) return null;
      const c = String(input).trim().toLowerCase();
      if (/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(c)) return c;
      if (ALLOWED_NAMED_COLORS.has(c)) return c;
      return null;
    }

    // safe markup parser -> returns DocumentFragment
    function nodesFromMarkup(text) {
      const frag = document.createDocumentFragment();
      let i = 0, bold = false, color = null;
      const colorStack = [];
      let buf = '';
      function flush() {
        if (!buf) return;
        let node;
        if (color && bold) {
          node = document.createElement('b');
          node.style.color = color;
          node.textContent = buf;
        } else if (color) {
          node = document.createElement('span');
          node.style.color = color;
          node.textContent = buf;
        } else if (bold) {
          node = document.createElement('b');
          node.textContent = buf;
        } else {
          node = document.createTextNode(buf);
        }
        frag.appendChild(node);
        buf = '';
      }

      while (i < text.length) {
        if (text.startsWith('**', i)) { flush(); bold = !bold; i+=2; continue; }
        if (text.startsWith('[b]', i)) { flush(); bold = true; i+=3; continue; }
        if (text.startsWith('[/b]', i)) { flush(); bold = false; i+=4; continue; }
        if (text.startsWith('[color=', i)) {
          const endBracket = text.indexOf(']', i+7);
          if (endBracket !== -1) {
            const raw = text.slice(i+7, endBracket);
            const ok = normalizeColor(raw);
            flush();
            colorStack.push(color);
            color = ok !== null ? ok : color;
            i = endBracket + 1;
            continue;
          }
        }
        if (text.startsWith('[/color]', i)) { flush(); color = colorStack.length ? colorStack.pop() : null; i+=8; continue; }

        buf += text[i++];
      }
      flush();
      return frag;
    }

    // manage UL controlled by us
    let ul = contentEl.querySelector('ul');
    if (!ul) { ul = document.createElement('ul'); contentEl.innerHTML = ''; contentEl.appendChild(ul); }

    function render(items) {
      ul.innerHTML = '';
      for (const raw of items) {
        const text = String(raw || '').trim();
        if (!text) continue;
        const li = document.createElement('li');
        li.appendChild(nodesFromMarkup(text));
        ul.appendChild(li);
      }
    }

    async function fetchAnnouncements() {
      try {
        const res = await fetch(SHEETS_ENDPOINT + '&t=' + Date.now(), { cache: 'no-store' });
        if (!res.ok) throw new Error('HTTP ' + res.status);
        const data = await res.json();
        const rows = Array.isArray(data.values) ? data.values : [];
        const items = rows
          .map(r => (r && r.length ? r[0] : ''))
          .map(v => (v == null ? '' : String(v)))
          .map(v => v.trim())
          .filter(v => v.length > 0 && !/^announcements?$/i.test(v));

        if (items.length) {
          render(items);
        } else {
          // fallback empty state
          ul.innerHTML = '<li><b>No announcements found.</b></li>';
        }
      } catch (err) {
        console.error('Failed to load announcements from Google Sheets:', err);
        // preserve existing content or show error
        ul.innerHTML = '<li><b>FAILED TO LOAD ANNOUNCEMENTS DATA</b></li>';
      }
    }

    // initial load + periodic refresh (same cadence as your previous code)
    fetchAnnouncements();
    setInterval(fetchAnnouncements, 5 * 60 * 1000); // refresh every 5 minutes
  })();
  </script>

  <!-- Clock logic for spooky clock overlay -->
  <script>
  (function(){
    const $ = s => document.querySelector(s);
    function updateClockHands() {
      const now = new Date();
      const s = now.getSeconds(), m = now.getMinutes(), h = now.getHours();
      const secondDeg = s * 6;
      const minuteDeg = m * 6 + s * 0.1;
      const hourDeg = (h % 12) * 30 + m * 0.5;
      const sEl = document.querySelectorAll('.second-hand, .minute-hand, .hour-hand');
      if (document.querySelector('.second-hand')) {
        document.querySelector('.second-hand').style.transform = `translate(-50%,-100%) rotate(${secondDeg}deg)`;
        document.querySelector('.minute-hand').style.transform = `translate(-50%,-100%) rotate(${minuteDeg}deg)`;
        document.querySelector('.hour-hand').style.transform = `translate(-50%,-100%) rotate(${hourDeg}deg)`;
      }
    }

    function positionClockOverlay() {
      const img = document.querySelector('.bg-room');
      const overlay = document.querySelector('.clock-overlay');
      if (!img || !overlay) return;
      const b = img.getBoundingClientRect();
      overlay.style.left = (b.left + b.width * 0.565) + 'px';
      overlay.style.top = (b.top + b.height * 0.395) + 'px';
    }

    window.addEventListener('resize', positionClockOverlay);
    window.addEventListener('load', () => {
      updateClockHands();
      positionClockOverlay();
      setInterval(updateClockHands, 1000);
    });
  })();
  </script>
</body>
</html>


