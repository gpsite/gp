<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GP</title>
<link rel="icon" type="image/png" href="https://gpsite.github.io/gp/img/logo.png">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="prefetch" href="https://gpsite.github.io/gp/pages/games/index.html" as="document" />
<link rel="prefetch" href="https://gpsite.github.io/gp/pages/movies/index.html" as="document" />
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">

<style>
:root{
  --bg-image: url("https://gpsite.github.io/gp/img/home/fall-bg.jpg"); /* Replace with your preferred background image */
  --glass-bg: rgba(255,255,255,0.12);
  --glass-bg-hover: rgba(255,255,255,0.18);
  --glass-border: rgba(255,255,255,0.35);
  --glass-highlight: rgba(255,255,255,0.55);
  --text:#fff;
  --panel-radius: 22px;
  --button-radius: 18px;
  --max-width: 1250px;
}

html,body{height:100%; margin:0;}
body{
  color:var(--text);
  font-family:"Poppins","Segoe UI",system-ui,-apple-system,Arial,Helvetica,sans-serif;
  -webkit-font-smoothing:antialiased;
  background: var(--bg-image) center / cover no-repeat fixed;
  display:flex;
  flex-direction:column;
  min-height:100vh;
}

/* Center wrapper */
.center-wrap{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:40px 32px;
  box-sizing:border-box;
}

/* Layout grid */
.main{
  display:grid;
  gap:42px;
  width:100%;
  max-width: var(--max-width);
  grid-template-columns: 1fr;
}

@media (min-width: 980px){
  .main{
    grid-template-columns: 340px 1fr;
    align-items:stretch;
  }
}

/* Glass */
.glass{
  background: var(--glass-bg);
  border: 1px solid var(--glass-border);
  backdrop-filter: blur(14px) saturate(130%);
  box-shadow:
    0 12px 34px rgba(0,0,0,0.35),
    inset 0 1px 0 var(--glass-highlight);
  border-radius: var(--panel-radius);
}
.glass.simple-btn{
  border-radius: var(--button-radius);
  box-shadow:
    0 10px 28px rgba(0,0,0,0.32),
    inset 0 1px 0 rgba(255,255,255,0.5);
}

nav.menu .logo-box{
  padding:0;
  background:none;
  border:none;
  box-shadow:none;
}
nav.menu .logo-box img{
  display:block;
  width:260px;
  height:auto;
  margin:0 auto;
}

nav.menu{
  display:flex;
  flex-direction:column;
  gap:20px;
  align-self:center;
}
a.btn{
  display:flex;
  align-items:center;
  justify-content:flex-start;
  text-decoration:none;
  color:#fff;
  font-weight:700;
  font-size:26px;
  letter-spacing:1px;
  padding:18px 24px;
  transition:background .2s ease, transform .1s ease, box-shadow .25s ease;
}
a.btn:not(.disabled):hover{
  background: var(--glass-bg-hover);
  transform:translateY(-2px);
  box-shadow:0 14px 40px rgba(0,0,0,0.38), inset 0 1px 0 rgba(255,255,255,0.55);
}
a.btn .meta{
  font-weight:600;
  opacity:.9;
  font-size:.8em;
  margin-left:6px;
}

/* Disabled / down state for buttons */
a.btn.disabled{
  opacity:0.55;
  filter:grayscale(60%);
  pointer-events:none; /* disable mouse interactions */
  cursor:default;
  color: rgba(255,255,255,0.75);
  box-shadow:none;
  transform:none;
  background: rgba(255,255,255,0.02);
  border: 1px solid rgba(255,255,255,0.06);
}

/* Announcements panel */
.announcements{
  padding:36px 38px 30px;
  min-height:480px;
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
  border-radius: var(--panel-radius);
}
.announcements h2{
  margin:0 0 24px;
  font-size: clamp(42px, 5vw, 70px);
  font-weight:800;
  line-height:1.05;
  text-shadow: 0 4px 20px rgba(0,0,0,.35);
  letter-spacing:1px;
  text-align:left;
}
.announcements-content{
  flex:1;
  font-size: clamp(18px, 2vw, 26px);
  font-weight:700;
  letter-spacing:.5px;
  text-align:left;
  overflow:auto;
  padding:0 6px;
}
.announcements-content ul{
  list-style:none;
  margin:0;
  padding:0;
}
.announcements-content li{
  margin:18px 0;
  text-shadow:0 2px 10px rgba(0,0,0,.35);
}

/* Scrollbar (optional subtle) */
.announcements-content::-webkit-scrollbar{ width:10px; }
.announcements-content::-webkit-scrollbar-track{ background:rgba(255,255,255,0.06); border-radius:6px; }
.announcements-content::-webkit-scrollbar-thumb{ background:rgba(255,255,255,0.22); border-radius:6px; }
.announcements-content::-webkit-scrollbar-thumb:hover{ background:rgba(255,255,255,0.30); }

/* Mobile */
@media (max-width:600px){
  a.btn{ font-size:22px; padding:16px 20px; }
  .announcements{ padding:30px 26px 26px; }
  .announcements h2{ font-size:48px; }
}

/* Falling leaves overlay */
.leaf-layer{
  position:fixed;
  inset:0;
  z-index:9999; /* above content, click-through enabled */
  pointer-events:none;
  overflow:hidden;
}
.leaf{
  position:absolute;
  top:-10vh;
  left:0;
  width:1em;
  height:1em;
  transform: translateY(-10vh);
  animation: fall var(--fall-duration, 14s) linear var(--delay, 0s) infinite;
  will-change: transform;
  opacity: var(--opacity, .95);
}
.leaf .sway{
  display:inline-block;
  animation: sway var(--sway-duration, 4s) ease-in-out var(--delay, 0s) infinite alternate;
  will-change: transform;
}
.leaf .spin{
  display:inline-block;
  filter: drop-shadow(0 6px 10px rgba(0,0,0,.25));
  animation: spin var(--spin-duration, 10s) linear var(--delay, 0s) infinite;
  will-change: transform;
}

@keyframes fall{
  0%{ transform: translateY(-10vh); }
  100%{ transform: translateY(110vh); }
}
@keyframes sway{
  0%{ transform: translateX(calc(var(--sway-range, 32px) * -1)); }
  100%{ transform: translateX(var(--sway-range, 32px)); }
}
@keyframes spin{
  100%{ transform: rotate(360deg); }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  .leaf-layer{ display:none !important; }
}
</style>
</head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-G6Q6EXT0RV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-G6Q6EXT0RV');
</script>

<body>
  <!-- Falling leaves layer (decorative) -->
  <div class="leaf-layer" id="leaf-layer" aria-hidden="true"></div>

  <!-- Centered layout -->
  <div class="center-wrap">
    <main class="main">
      <!-- Left menu -->
      <nav class="menu">
          <div class="logo-box">
             <img src="https://gpsite.github.io/gp/img/logo.png" alt="GP Logo">
          </div>
          
        <a class="btn glass simple-btn" href="pages/games/index.html" aria-label="Games">GAMES</a>
        <a class="btn glass simple-btn" href="pages/movies/index.html" aria-label="Movies">MOVIES</a>
        <a class="btn glass simple-btn" href="pages/chat/index.html" aria-label="Chat">CHAT <span class="meta">(BETA)</span></a>
        <!-- GP-CLANKER is DOWN: visually disabled and non-interactive -->
        <a class="btn glass simple-btn disabled" aria-label="GP-CLANKER (down)" aria-disabled="true" tabindex="-1">GP-CLANKER <span class="meta">(DOWN)</span></a>
      </nav>

      <!-- Announcements -->
      <section id="announcementsBox" class="announcements glass">
        <h2>Announcements</h2>
        <div class="announcements-content" id="announcementsContent">
          <ul>
            <li>LOADING ANNOUNCEMENTS...</li>
          </ul>
        </div>
      </section>
    </main>
  </div>

  <!-- Announcements fetch + safe markup parser -->
  <script>
  (function(){
    const SHEETS_ENDPOINT = 'https://sheets.googleapis.com/v4/spreadsheets/1nw0SDop0IeFr6q776thp_eSCZZulaxZBtM55ECrHD5A/values/home?key=AIzaSyBdnupZe6bJH43XE0Hj77n0AmlR3wVfN9M';
    const contentEl = document.getElementById('announcementsContent');
    if (!contentEl) return;

    const ALLOWED_NAMED_COLORS = new Set([
      'black','white','gray','grey','silver','lightgray','darkgray',
      'red','crimson','maroon','orange','coral','tomato',
      'yellow','gold','khaki',
      'green','lime','olive','seagreen','teal',
      'blue','navy','royalblue','dodgerblue','deepskyblue','skyblue',
      'indigo','violet','purple','magenta','fuchsia','pink','hotpink',
      'cyan','aqua','turquoise'
    ]);

    function normalizeColor(input){
      if(!input) return null;
      const c = String(input).trim().toLowerCase();
      if(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(c)) return c;
      if(ALLOWED_NAMED_COLORS.has(c)) return c;
      return null;
    }

    function nodesFromMarkup(text){
      const frag = document.createDocumentFragment();
      let i=0, bold=false, color=null;
      const colorStack=[];
      let buf='';
      function flush(){
        if(!buf) return;
        let node;
        if(color && bold){
          node=document.createElement('b');
          node.style.color=color;
          node.textContent=buf;
        }else if(color){
          node=document.createElement('span');
          node.style.color=color;
          node.textContent=buf;
        }else if(bold){
          node=document.createElement('b');
          node.textContent=buf;
        }else{
          node=document.createTextNode(buf);
        }
        frag.appendChild(node);
        buf='';
      }
      while(i<text.length){
        if(text.startsWith('**',i)){ flush(); bold=!bold; i+=2; continue; }
        if(text.startsWith('[b]',i)){ flush(); bold=true; i+=3; continue; }
        if(text.startsWith('[/b]',i)){ flush(); bold=false; i+=4; continue; }
        if(text.startsWith('[color=',i)){
          const endBracket=text.indexOf(']',i+7);
          if(endBracket!==-1){
            const raw=text.slice(i+7,endBracket);
            const ok=normalizeColor(raw);
            flush();
            colorStack.push(color);
            color= ok!==null ? ok : color;
            i=endBracket+1;
            continue;
          }
        }
        if(text.startsWith('[/color]',i)){ flush(); color=colorStack.length?colorStack.pop():null; i+=8; continue; }
        buf+=text[i++];
      }
      flush();
      return frag;
    }

    let ul = contentEl.querySelector('ul');
    if(!ul){
      ul=document.createElement('ul');
      contentEl.innerHTML='';
      contentEl.appendChild(ul);
    }

    function render(items){
      ul.innerHTML='';
      for(const raw of items){
        const text=String(raw||'').trim();
        if(!text) continue;
        const li=document.createElement('li');
        li.appendChild(nodesFromMarkup(text));
        ul.appendChild(li);
      }
    }

    async function fetchAnnouncements(){
      try{
        const res=await fetch(SHEETS_ENDPOINT+'&t='+Date.now(),{cache:'no-store'});
        if(!res.ok) throw new Error('HTTP '+res.status);
        const data=await res.json();
        const rows=Array.isArray(data.values)?data.values:[];
        const items=rows
          .map(r=> (r && r.length ? r[0] : ''))
          .map(v=> (v==null ? '' : String(v).trim()))
          .filter(v=> v.length>0 && !/^announcements?$/i.test(v));
        if(items.length){
          render(items);
        }else{
          ul.innerHTML='<li>No announcements found.</li>';
        }
      }catch(err){
        console.error('Failed to load announcements from Google Sheets:', err);
        ul.innerHTML='<li>FAILED TO LOAD ANNOUNCEMENTS DATA</li>';
      }
    }

    fetchAnnouncements();
    setInterval(fetchAnnouncements, 5*60*1000);
  })();
  </script>

  <!-- Falling leaves generator -->
  <script>
    (function(){
      const layer = document.getElementById('leaf-layer');
      if (!layer) return;

      // Respect reduced motion
      try{
        if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
          return;
        }
      }catch(e){}

      const LEAFS = ['üçÅ','üçÇ','üçÉ'];
      const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);

      // Scale number of leaves by viewport width (with sensible bounds)
      const COUNT = Math.max(12, Math.min(40, Math.round(vw / 40)));

      function rand(min, max){ return Math.random() * (max - min) + min; }

      for (let i = 0; i < COUNT; i++){
        const leaf = document.createElement('span');
        leaf.className = 'leaf';

        const sway = document.createElement('span');
        sway.className = 'sway';

        const spin = document.createElement('span');
        spin.className = 'spin';
        spin.textContent = LEAFS[Math.floor(Math.random() * LEAFS.length)];

        // Random properties
        const startLeftVw = rand(0, 100);
        const sizePx = rand(16, 34);
        const fallDuration = rand(10, 22); // seconds
        const swayDuration = rand(2.2, 5.2); // seconds
        const swayRange = rand(18, 60); // px
        const spinDuration = rand(6, 13); // seconds
        const delay = -rand(0, 22); // negative delay staggers leaves
        const opacity = rand(0.6, 1);

        leaf.style.left = startLeftVw.toFixed(2) + 'vw';
        leaf.style.setProperty('--fall-duration', fallDuration.toFixed(2) + 's');
        leaf.style.setProperty('--sway-duration', swayDuration.toFixed(2) + 's');
        leaf.style.setProperty('--sway-range', swayRange.toFixed(0) + 'px');
        leaf.style.setProperty('--spin-duration', spinDuration.toFixed(2) + 's');
        leaf.style.setProperty('--delay', delay.toFixed(2) + 's');
        leaf.style.setProperty('--opacity', opacity.toFixed(2));

        // Randomize spin direction
        spin.style.animationDirection = Math.random() < 0.5 ? 'normal' : 'reverse';
        spin.style.fontSize = sizePx.toFixed(0) + 'px';

        sway.appendChild(spin);
        leaf.appendChild(sway);
        layer.appendChild(leaf);
      }

      // Optional: update density on resize (basic, non-thrashy)
      let resizeTimer = null;
      window.addEventListener('resize', () => {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(() => {
          // If viewport grew a lot, add a few more
          const current = layer.children.length;
          const vwNow = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
          const target = Math.max(12, Math.min(40, Math.round(vwNow / 40)));
          const toAdd = Math.max(0, target - current);
          for (let i = 0; i < toAdd; i++){
            const evt = new Event('addLeaf');
            layer.dispatchEvent(evt);
          }
        }, 250);
      });

      // Support adding extra leaves later if needed
      layer.addEventListener('addLeaf', () => {
        const leaf = document.createElement('span');
        leaf.className = 'leaf';
        const sway = document.createElement('span');
        sway.className = 'sway';
        const spin = document.createElement('span');
        spin.className = 'spin';
        spin.textContent = LEAFS[Math.floor(Math.random() * LEAFS.length)];

        const startLeftVw = rand(0, 100);
        const sizePx = rand(16, 34);
        const fallDuration = rand(10, 22);
        const swayDuration = rand(2.2, 5.2);
        const swayRange = rand(18, 60);
        const spinDuration = rand(6, 13);
        const delay = -rand(0, 22);
        const opacity = rand(0.6, 1);

        leaf.style.left = startLeftVw.toFixed(2) + 'vw';
        leaf.style.setProperty('--fall-duration', fallDuration.toFixed(2) + 's');
        leaf.style.setProperty('--sway-duration', swayDuration.toFixed(2) + 's');
        leaf.style.setProperty('--sway-range', swayRange.toFixed(0) + 'px');
        leaf.style.setProperty('--spin-duration', spinDuration.toFixed(2) + 's');
        leaf.style.setProperty('--delay', delay.toFixed(2) + 's');
        leaf.style.setProperty('--opacity', opacity.toFixed(2));

        spin.style.animationDirection = Math.random() < 0.5 ? 'normal' : 'reverse';
        spin.style.fontSize = sizePx.toFixed(0) + 'px';

        sway.appendChild(spin);
        leaf.appendChild(sway);
        layer.appendChild(leaf);
      });
    })();
  </script>
</body>
</html>
